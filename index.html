<!DOCTYPE html>
<html>
<head>
    <title>secUPD - Hazard Map</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Raleway:wght@700&family=Oswald:wght@600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <!-- Supabase will be imported as an ES module inside main.js via esm.sh -->
</head>
<body>
    <header>
        <h1 class="site-title"><span class="sec-part">sec</span><span class="upd-part">UPD</span></h1>

        <!-- Theme toggle (top-right) -->
        <button id="theme-toggle" class="theme-toggle" aria-pressed="false" title="Toggle light/dark mode">üåô</button>

        <!-- Tabs moved to the top header area -->
        <nav class="tabs" aria-label="Top header tabs">
            <div class="tab-buttons" role="tablist" aria-label="Top sections">
                <button class="tab-button active" role="tab" aria-selected="true" aria-controls="tab-who" id="tab-btn-who">Who we are</button>
                <button class="tab-button" role="tab" aria-selected="false" aria-controls="tab-instructions" id="tab-btn-instructions">Instructions</button>
                <button class="tab-button" role="tab" aria-selected="false" aria-controls="tab-hazards" id="tab-btn-hazards">Hazards</button>
                <button class="tab-button" role="tab" aria-selected="false" aria-controls="tab-disclaimer" id="tab-btn-disclaimer">Disclaimer</button>
            </div>
        </nav>
    </header>

    <div class="container">
        <aside class="sidebar">
            <!-- Tab panels for the header tabs (content shown in the sidebar) -->
            <div class="tab-panels">
                <div id="tab-who" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-who">
                    <h3>Who we are</h3>
                    <p><strong>SECUPD:</strong> Security, Environment, and Crisis mapping of UP Diliman<p>
                    <p>This website was created by the group BLOOMS as a final project requirement for Env Sci WFW, 1st Sem, AY ‚Äò25-‚Äô26. The goal of this project is to make a community-sustained hazard map for UP Diliman to encourage students and community-goers alike to safely travel through the campus on foot, therefore reducing their collective carbon footprint. We, members of BLOOMS, hope that you, the user, would find this website helpful and use it for its intended purpose.</p>
                </div>
                <div id="tab-instructions" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-instructions" hidden>
                    <h3>Instructions</h3>
                    <ul>
                        <li>To record your experience, select a location on the map and choose a pin type among the choices. Pins may only be added within the campus area. Enter a brief description of the incident and click ‚ÄúSAVE.‚Äù</li>
                        <li><strong>Add a pin:</strong> Click anywhere inside the campus bounds on the map and enter a name. The pin appears in the Hazards list.</li>
                        <li><strong>Rename a pin:</strong> Double‚Äëclick the marker on the map and enter the new name.</li>
                        <li><strong>Locate a pin:</strong> Click its entry in the Hazards list to center the map and open its popup.</li>
                        <li><strong>Delete a pin:</strong> Use the black trash icon on the left of the item, then confirm.</li>
                        <li><strong>Nearest landmark:</strong> After adding a pin the website shows your nearest landmark; results show on the Hazards Tab.</li>
                        <li><strong>Theme toggle:</strong> Use the moon/sun button (top right) to switch dark/light modes.</li>
                        <li><strong>Shared pins:</strong> When connected, pins sync via Supabase (footer shows status). If offline, changes save locally.</li>
                        <li><strong>Bounds:</strong> Pins can only be placed within the defined UP Diliman boundary; clicks outside are rejected.</li>
                    </ul>
                </div>

                <div id="tab-hazards" class="tab-panel hazard-panel" role="tabpanel" aria-labelledby="tab-btn-hazards" hidden>
                    <h3>Hazard List</h3>
                    <div class="hazard-list" id="hazard-list">
                        <!-- hazard items will be shown here -->
                        <p class="muted">No hazards listed yet.</p>
                    </div>
                </div>

                <div id="tab-disclaimer" class="tab-panel" role="tabpanel" aria-labelledby="tab-btn-disclaimer" hidden>
                    <h3>Disclaimer</h3>
                    <p>The data shown is for demonstration only. Overpass and Nominatim lookups are subject to external service availability and may be rate-limited.</p>
                </div>
            </div>
        </aside>

        <main class="map-container">
            <div id="map"></div>
        </main>
    </div>

    <footer>
        <p>¬© 2025 Hazard Map Project <span id="conn-status" class="conn-status" aria-live="polite" style="margin-left:8px;color:#7aa2f7"></span></p>
    </footer>

    <!-- Lightweight Pin Name Dialog -->
    <div id="name-dialog" class="name-dialog" hidden aria-hidden="true" role="dialog" aria-labelledby="name-dialog-title">
        <div class="name-dialog-backdrop"></div>
        <div class="name-dialog-card">
            <h4 id="name-dialog-title">Name this pin</h4>
            <p class="name-dialog-help">Keep it short and clear (e.g., "Broken sidewalk near Palma Hall").</p>
            <input id="name-dialog-input" type="text" maxlength="80" placeholder="Enter pin name" aria-label="Pin name" />
            <div class="name-dialog-actions">
                <button id="name-dialog-cancel" class="btn-secondary" type="button">Cancel</button>
                <button id="name-dialog-save" class="btn-primary" type="button">Save</button>
            </div>
        </div>
    </div>

    <!-- Delete Confirmation Dialog -->
    <div id="delete-dialog" class="name-dialog" hidden aria-hidden="true" role="dialog" aria-labelledby="delete-dialog-title">
        <div class="name-dialog-backdrop"></div>
        <div class="name-dialog-card">
            <h4 id="delete-dialog-title">Delete this pin?</h4>
            <p class="name-dialog-help">This action cannot be undone.</p>
            <div class="name-dialog-actions">
                <button id="delete-dialog-cancel" class="btn-secondary" type="button">Cancel</button>
                <button id="delete-dialog-confirm" class="btn-primary" type="button">Delete</button>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <!-- Load app as module so it can import Supabase from esm.sh -->
    <script type="module" src="main.js"></script>
</body>
</html>
